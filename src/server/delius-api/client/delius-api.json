{"openapi":"3.0.3","info":{"title":"Delius API","description":"Delius API Documentation","contact":{"name":"HMPPS Digital Studio","email":"dps-hmpps@digital.justice.gov.uk"},"license":{"name":"Open Government Licence v3.0","url":"https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"},"version":"2021-10-21.2608.1d394b9"},"servers":[{"url":"https://delius-api.test.probation.service.justice.gov.uk:443","description":"Inferred Url"}],"tags":[{"name":"Contact v1","description":"Contact API"},{"name":"Document v1","description":"Document API"},{"name":"NSI v1","description":"NSI API"},{"name":"Staff v1","description":"Staff API"},{"name":"Team v1","description":"Team API"},{"name":"operation-handler","description":"Operation Handler"}],"paths":{"/v1/contact":{"post":{"tags":["Contact v1"],"summary":"Creates a new contact","operationId":"createContact","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NewContact"}}}},"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContactDto"}}}},"201":{"description":"The contact has been successfully created.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContactDto"}}}}},"security":[{"Bearer":["global"]}]}},"/v1/contact/search":{"post":{"tags":["Contact v1"],"summary":"Search for a list of matching contacts within the context of a single offender, determined by the crn parameter. The query will be matched against the type, outcome, description and notes fields on all contacts linked to the offender.\n\n","operationId":"searchContact","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SearchContactRequest"}}}},"responses":{"200":{"description":"Success","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SearchContactResponse"}}}},"400":{"description":"Invalid input query"},"404":{"description":"CRN not found, or the offender is not accessible by the authorised user based on their datasets"}},"security":[{"Bearer":["global"]}]}},"/v1/contact/{id}":{"delete":{"tags":["Contact v1"],"summary":"Deletes an existing contact by id","operationId":"deleteContact","parameters":[{"name":"id","in":"path","description":"id","required":true,"style":"simple","schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK"}},"security":[{"Bearer":["global"]}]},"patch":{"tags":["Contact v1"],"summary":"Patches an existing contact by id","operationId":"patchContact","parameters":[{"name":"id","in":"path","description":"id","required":true,"style":"simple","schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JsonPatch"}},"application/json-patch+json":{"schema":{"$ref":"#/components/schemas/JsonPatch"}}}},"responses":{"200":{"description":"The contact was successfully patched.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContactDto"}}}}},"security":[{"Bearer":["global"]}]}},"/v1/contact/{id}/replace":{"post":{"tags":["Contact v1"],"summary":"Replace/reschedule an existing contact","operationId":"replaceContact","parameters":[{"name":"id","in":"path","description":"id","required":true,"style":"simple","schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReplaceContact"}}}},"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContactDto"}}}},"201":{"description":"The outcome was stored on the existing contact, and a new contact was created with the provided date/times.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContactDto"}}}},"404":{"description":"No contact exists with that ID"}},"security":[{"Bearer":["global"]}]}},"/v1/document/upload/contact-document":{"post":{"tags":["Document v1"],"summary":"Adds a Document to a Contact","operationId":"addDocumentToContact","requestBody":{"content":{"multipart/form-data":{"schema":{"required":["contactId","crn"],"type":"object","properties":{"contactId":{"type":"integer","description":"contactId","format":"int64"},"crn":{"type":"string","description":"crn"}}},"encoding":{"contactId":{"contentType":"text/plain"},"crn":{"contentType":"text/plain"}}}}},"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentDetails"}},"multipart/form-data":{"schema":{"$ref":"#/components/schemas/DocumentDetails"}}}},"201":{"description":"The document has been saved successfully.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentDetails"}}}},"400":{"description":"Offender with code 'CRN' does not exist"},"404":{"description":"Missing CRN folder from Remote Document Store"}},"security":[{"Bearer":["global"]}]}},"/v1/nsi":{"post":{"tags":["NSI v1"],"summary":"Creates a new NSI","operationId":"createNsi","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NewNsi"}}}},"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NsiDto"}}}},"201":{"description":"The NSI has been successfully created.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NsiDto"}}}}},"security":[{"Bearer":["global"]}]}},"/v1/nsi/{id}":{"patch":{"tags":["NSI v1"],"summary":"Patches an existing NSI by id","operationId":"patchNsi","parameters":[{"name":"id","in":"path","description":"id","required":true,"style":"simple","schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JsonPatch"}},"application/json-patch+json":{"schema":{"$ref":"#/components/schemas/JsonPatch"}}}},"responses":{"200":{"description":"The NSI was successfully patched.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NsiDto"}}}}},"security":[{"Bearer":["global"]}]}},"/health":{"get":{"tags":["operation-handler"],"summary":"handle","operationId":"getHealth","requestBody":{"content":{"application/json":{"schema":{"type":"object","additionalProperties":{"type":"string"}}}}},"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"type":"object"}},"application/vnd.spring-boot.actuator.v3+json":{"schema":{"type":"object"}},"application/vnd.spring-boot.actuator.v2+json":{"schema":{"type":"object"}}}}}}},"/info":{"get":{"tags":["operation-handler"],"summary":"handle","operationId":"getInfo","requestBody":{"content":{"application/json":{"schema":{"type":"object","additionalProperties":{"type":"string"}}}}},"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"type":"object"}},"application/vnd.spring-boot.actuator.v3+json":{"schema":{"type":"object"}},"application/vnd.spring-boot.actuator.v2+json":{"schema":{"type":"object"}}}}}}},"/v1/staff":{"post":{"tags":["Staff v1"],"summary":"Creates a new staff member","operationId":"createStaff","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NewStaff"}}}},"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/StaffDto"}}}},"201":{"description":"The staff member has been successfully created.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/StaffDto"}}}}},"security":[{"Bearer":["global"]}]}},"/v1/team":{"post":{"tags":["Team v1"],"summary":"Creates a new team","operationId":"create","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NewTeam"}}}},"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TeamDto"}}}},"201":{"description":"The team has been successfully created.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TeamDto"}}}}},"security":[{"Bearer":["global"]}]}}},"components":{"schemas":{"ContactDto":{"title":"ContactDto","required":["alert","date","id","offenderCrn","provider","providerDescription","sensitive","staff","staffFirstName","staffLastName","team","teamDescription","type","typeDescription"],"type":"object","properties":{"alert":{"type":"boolean"},"date":{"type":"string","format":"date"},"description":{"type":"string"},"endTime":{"type":"string"},"enforcement":{"type":"string"},"enforcementDescription":{"type":"string"},"eventId":{"type":"integer","format":"int64"},"id":{"type":"integer","format":"int64"},"notes":{"type":"string"},"nsiId":{"type":"integer","format":"int64"},"offenderCrn":{"type":"string"},"officeLocation":{"type":"string"},"officeLocationDescription":{"type":"string"},"outcome":{"type":"string"},"outcomeDescription":{"type":"string"},"provider":{"type":"string"},"providerDescription":{"type":"string"},"rarActivity":{"type":"boolean"},"requirementId":{"type":"integer","format":"int64"},"sensitive":{"type":"boolean"},"staff":{"type":"string"},"staffFirstName":{"type":"string"},"staffLastName":{"type":"string"},"startTime":{"type":"string"},"team":{"type":"string"},"teamDescription":{"type":"string"},"type":{"type":"string"},"typeDescription":{"type":"string"}}},"DocumentDetails":{"title":"DocumentDetails","required":["author","creationDate","crn","dateLastModified","documentName","documentType","entityId","entityType","lastModifiedUser","locked","remoteDocumentId","reserved"],"type":"object","properties":{"author":{"type":"string"},"authorProvider":{"type":"string"},"createdProvider":{"type":"string"},"creationDate":{"type":"string","format":"date-time"},"crn":{"type":"string"},"dateLastModified":{"type":"string","format":"date-time"},"docRenamed":{"type":"boolean"},"documentName":{"type":"string"},"documentType":{"type":"string"},"entityId":{"type":"integer","format":"int64"},"entityType":{"type":"string"},"id":{"type":"integer","format":"int64"},"lastModifiedUser":{"type":"string"},"lockOwner":{"type":"string"},"locked":{"type":"boolean"},"remoteDocumentId":{"type":"string"},"reservationOwner":{"type":"string"},"reserved":{"type":"boolean"}}},"JsonPatch":{"title":"JsonPatch","type":"object"},"NewContact":{"title":"NewContact","required":["date","offenderCrn","provider","staff","startTime","team","type"],"type":"object","properties":{"alert":{"type":"boolean"},"date":{"type":"string","format":"date"},"description":{"maxLength":200,"minLength":0,"type":"string"},"endTime":{"type":"string"},"enforcement":{"maxLength":10,"minLength":0,"type":"string"},"eventId":{"type":"integer","format":"int64"},"notes":{"maxLength":4000,"minLength":0,"type":"string"},"nsiId":{"type":"integer","format":"int64"},"offenderCrn":{"pattern":"^[a-zA-Z][0-9]{6}$","type":"string"},"officeLocation":{"maxLength":7,"minLength":0,"type":"string"},"outcome":{"maxLength":10,"minLength":0,"type":"string"},"provider":{"maxLength":3,"minLength":0,"type":"string"},"rarActivity":{"type":"boolean"},"requirementId":{"type":"integer","format":"int64"},"sensitive":{"type":"boolean"},"staff":{"maxLength":7,"minLength":0,"type":"string"},"startTime":{"type":"string"},"team":{"maxLength":6,"minLength":0,"type":"string"},"type":{"maxLength":10,"minLength":0,"type":"string"}}},"NewNsi":{"title":"NewNsi","type":"object","properties":{"endDate":{"type":"string","description":"The actual intervention end date, an end date is required if outcome is provided","format":"date"},"eventId":{"type":"integer","description":"An optional event ID that the new NSI will be associated to","format":"int64"},"expectedEndDate":{"type":"string","description":"The expected intervention end date","format":"date"},"expectedStartDate":{"type":"string","description":"The expected intervention start date","format":"date"},"intendedProvider":{"maxLength":3,"minLength":0,"type":"string","description":"The provider"},"length":{"type":"integer","description":"The length of the intervention, the units of this are determined by the NSI type selected","format":"int64"},"manager":{"description":"The active manager associated to this NSI","$ref":"#/components/schemas/NewNsiManager"},"notes":{"maxLength":4000,"minLength":0,"type":"string","description":"General notes"},"offenderCrn":{"pattern":"^[a-zA-Z][0-9]{6}$","type":"string","description":"The offender CRN"},"outcome":{"maxLength":100,"minLength":0,"type":"string","description":"The outcome of the intervention. required if an end date is provided"},"referralDate":{"type":"string","description":"The date of the referral","format":"date"},"requirementId":{"type":"integer","description":"An optional requirement ID that the new NSI will be associated to, an event is required for association to a requirement","format":"int64"},"startDate":{"type":"string","description":"The actual intervention start date","format":"date"},"status":{"maxLength":20,"minLength":0,"type":"string","description":"The status of the intervention"},"statusDate":{"type":"string","description":"The status date","format":"date-time"},"subType":{"maxLength":20,"minLength":0,"type":"string","description":"The sub type of the NSI, this is required for some NSI types"},"type":{"maxLength":20,"minLength":0,"type":"string","description":"The type of the NSI"}}},"NewNsiManager":{"title":"NewNsiManager","type":"object","properties":{"provider":{"maxLength":3,"minLength":0,"type":"string","description":"The code of the provider managing this intervention"},"staff":{"maxLength":7,"minLength":0,"type":"string","description":"The officer code of the staff managing this intervention"},"team":{"maxLength":6,"minLength":0,"type":"string","description":"The code of the team managing this intervention"}}},"NewStaff":{"title":"NewStaff","required":["teams"],"type":"object","properties":{"firstName":{"maxLength":35,"minLength":0,"type":"string","description":"The firstname of the staff member"},"lastName":{"maxLength":35,"minLength":0,"type":"string","description":"The lastname of the staff member"},"provider":{"maxLength":3,"minLength":0,"type":"string","description":"The provider code of the staff member"},"teams":{"type":"array","items":{"type":"string"}}}},"NewTeam":{"title":"NewTeam","type":"object","properties":{"cluster":{"type":"string","description":"The cluster code"},"description":{"maxLength":50,"minLength":0,"type":"string","description":"The description for the new team"},"ldu":{"type":"string","description":"The local delivery unit code"},"provider":{"type":"string","description":"The provider code"},"type":{"type":"string","description":"The team type code"},"unpaidWorkTeam":{"type":"boolean","description":"If the team is an unpaid work team","example":false}}},"NsiDto":{"title":"NsiDto","required":["id","intendedProvider","manager","offenderCrn","referralDate","status","statusDate","type"],"type":"object","properties":{"endDate":{"type":"string","format":"date"},"eventId":{"type":"integer","format":"int64"},"expectedEndDate":{"type":"string","format":"date"},"expectedStartDate":{"type":"string","format":"date"},"id":{"type":"integer","format":"int64"},"intendedProvider":{"type":"string"},"length":{"type":"integer","format":"int64"},"manager":{"$ref":"#/components/schemas/NsiManagerDto"},"notes":{"type":"string"},"offenderCrn":{"type":"string"},"outcome":{"type":"string"},"referralDate":{"type":"string","format":"date"},"requirementId":{"type":"integer","format":"int64"},"startDate":{"type":"string","format":"date"},"status":{"type":"string"},"statusDate":{"type":"string","format":"date-time"},"subType":{"type":"string"},"type":{"type":"string"}}},"NsiManagerDto":{"title":"NsiManagerDto","required":["id","provider"],"type":"object","properties":{"id":{"type":"integer","format":"int64"},"provider":{"type":"string"},"staff":{"type":"string"},"team":{"type":"string"}}},"ReplaceContact":{"title":"ReplaceContact","required":["date","offenderCrn","outcome","startTime"],"type":"object","properties":{"date":{"type":"string","format":"date"},"endTime":{"type":"string"},"eventId":{"type":"integer","format":"int64"},"nsiId":{"type":"integer","format":"int64"},"offenderCrn":{"pattern":"^[a-zA-Z][0-9]{6}$","type":"string"},"officeLocation":{"maxLength":7,"minLength":0,"type":"string"},"outcome":{"maxLength":10,"minLength":0,"type":"string"},"requirementId":{"type":"integer","format":"int64"},"startTime":{"type":"string"}}},"SearchContact":{"title":"SearchContact","required":["date","highlights","id","type","typeDescription"],"type":"object","properties":{"date":{"type":"string","format":"date"},"description":{"type":"string"},"endTime":{"type":"string"},"highlights":{"type":"object","additionalProperties":{"type":"array","items":{"type":"string"}}},"id":{"type":"integer","format":"int64"},"lastUpdatedDateTime":{"type":"string","format":"date-time"},"notes":{"type":"string"},"outcome":{"type":"string"},"outcomeDescription":{"type":"string"},"startTime":{"type":"string"},"type":{"type":"string"},"typeDescription":{"type":"string"}}},"SearchContactRequest":{"title":"SearchContactRequest","required":["crn"],"type":"object","properties":{"crn":{"pattern":"^[a-zA-Z][0-9]{6}$","type":"string","description":"Case Reference Number (CRN) for the offender in Delius","example":"A123456"},"matchAllTerms":{"type":"boolean","description":"When true, only return contacts that match all terms in the query. Analogous to AND versus OR.","example":true},"page":{"type":"integer","description":"Page number to return, starting from 0.","format":"int32","example":0},"pageSize":{"type":"integer","description":"The number of results to return per page.","format":"int32","example":10},"query":{"maxLength":1000,"minLength":0,"type":"string","description":"Text to search for within the offender's contacts. Leave blank to return all contacts.","example":"planned office visit on 01/01/2000"},"sort":{"type":"string","description":"Sort the results by the provided field. Defaults to relevance (best match) when the query is non-empty, or by lastUpdatedDateTime otherwise.","example":"relevance","enum":["LAST_UPDATED_DATETIME","RELEVANCE"]},"sortDirection":{"type":"string","description":"Sort the results by ascending or descending order. Defaults to descending.","example":"asc","enum":["ASCENDING","DESCENDING"]}}},"SearchContactResponse":{"title":"SearchContactResponse","required":["page","size","totalPages","totalResults"],"type":"object","properties":{"page":{"type":"integer","format":"int32"},"results":{"type":"array","items":{"$ref":"#/components/schemas/SearchContact"}},"size":{"type":"integer","format":"int32"},"totalPages":{"type":"integer","format":"int32"},"totalResults":{"type":"integer","format":"int64"}}},"StaffDto":{"title":"StaffDto","required":["code","firstName","lastName","privateStaff","provider","startDate","teams"],"type":"object","properties":{"code":{"type":"string"},"firstName":{"type":"string"},"lastName":{"type":"string"},"privateStaff":{"type":"boolean"},"provider":{"type":"string"},"startDate":{"type":"string","format":"date"},"teams":{"type":"array","items":{"type":"string"}}}},"TeamDto":{"title":"TeamDto","required":["code","description","ldu","provider","startDate","type","unpaidWorkTeam"],"type":"object","properties":{"code":{"type":"string"},"description":{"type":"string"},"endDate":{"type":"string","format":"date"},"ldu":{"type":"string"},"provider":{"type":"string"},"startDate":{"type":"string","format":"date"},"type":{"type":"string"},"unpaidWorkTeam":{"type":"boolean"}}}},"securitySchemes":{"Bearer":{"type":"http","scheme":"bearer","bearerFormat":"JWT"}}}}